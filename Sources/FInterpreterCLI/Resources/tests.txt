# 1. Literals and simple assignment
42
-7
3.14
true
null
(setq x 5) x
(setq y -10) (plus x y)

# 2. Semantic errors: invalid literals and assignment
3..14
(setq 123 456)
(setq x 5)) x
(setq)

# 3. Quote and lists
'x
'hello
(setq operations '(plus minus times divide)) operations
(setq nested '((1 2) (3 4))) nested

# 4. Semantic errors: invalid quote usage
(quote)
(quote x y)
(setq invalid '(1 2))
(setq bad-list '(1 . 2))

# 5. Arithmetic operations
(plus 10 20)
(minus 15 7)
(times 6 8)
(divide 20 4)

# 6. Semantic errors: arithmetic type errors
(plus true 10)
(minus 'hello' 5)
(times 2 null)
(divide 10 false)

# 7. Comparisons and predicates
(less 5 10)
(equal 3.0 3.0)
(isint 42)
(isreal 3.14)
(isatom 'x)
(islist '(a b c))
(isnull null)

# 8. Semantic errors: comparison type mismatches
(less true false)
(equal 1 "one")
(isint true)
(isreal null)
(less null 5)

# 9. Head / tail / cons operations
(head '(first second third))
(tail '(head tail body))
(cons 'new '(existing list))
(cons 1 (cons 2 (cons 3 null)))

# 10. Semantic errors: list operation type errors
(head 42)
(tail "string")
(cons 1 2)
(cons '(list) 'atom)

# 11. Logical operators
(and true true)
(or false true)
(xor true false)
(not false)
(and (less 1 2) (greater 5 3))
(or (equal 1 2) (equal 3 3))

# 12. Semantic errors: logical operator type errors
(and 1 true)
(or "string" false)
(xor null true)
(not 42)
(and true 0)

# 13. Func / lambda / function calls
(func square (x) (times x x))
(square 5)
(setq double (lambda (x) (plus x x)))
(double 10)
((lambda (x y) (times x y)) 3 4)
(func greet (name)
  (cons 'hello (cons name null)))
(greet 'world)

# 14. Semantic errors: function definition and call errors
(func 123 (x) x)
(lambda (1 2) 3)
(square 1 2 3)
((lambda (x) x))

# 15. Prog, local scope and return
(prog (a b)
  (setq a 10)
  (setq b 20)
  (plus a b))
(func get-value ()
  (prog ()
    (return 42)
    100))
(get-value)
(prog (x)
  (setq x 5)
  (setq x (times x 2))
  x)
(func early-return (flag)
  (prog ()
    (cond flag (return 'early) null)
    'late))
(early-return true)

# 16. Semantic errors: prog and return errors
(prog (1) (setq x 5) x)
(return 42)
(prog (x) (setq x 5) (return))
(func bad-return () return 42)

# 17. Cond and while control structures
(cond (less 2 3) 'yes 'no)
(cond (greater 5 10) 'big 'small)
(cond (equal 1 1) 'equal)
(cond (isnull null) 'is-null 'not-null)
(prog (counter)
  (setq counter 0)
  (while (less counter 3)
    (setq counter (plus counter 1)))
  counter)


# 18. Semantic errors: cond and while type errors
(cond 42 'true 'false)
(cond (less 1 2))
(while "string" (break))
(while true)

# 19. Break inside while loops
(prog (i)
  (setq i 0)
  (while (less i 10)
    (setq i (plus i 1))
    (cond (greater i 5) (break)))
  i)
(prog (count)
  (setq count 0)
  (while true
    (setq count (plus count 1))
    (cond (greater count 3) (break)))
  count)

# 20. Semantic errors: break usage errors
(break)
(prog (x) (setq x 5) (break) x)
(cond true (break) null)
(plus 1 (break))

# 21. Eval function
(eval '(plus 2 3))
(eval 42)
(eval 'x)
(eval '(cond true 'evaluated 'skipped))

# 22. Semantic errors: eval type errors
(eval)
(eval true false)
(eval '(1 2 3))
(eval '(plus 1))

# 23. Recursion: factorial and Fibonacci
(func fact (n)
  (cond (less n 2)
    1
    (times n (fact (minus n 1)))))
(fact 5)
(func fib (n)
  (cond (less n 2)
    n
    (plus (fib (minus n 1)) (fib (minus n 2)))))
(fib 6)

# 24. Semantic errors: recursion errors
(func infinite (x) (infinite x))
(infinite 1)
(func bad-rec (n) (bad-rec true))
(bad-rec 5)

# 25. Closures and higher-order functions
(prog ()
  (setq maker (lambda (x)
    (lambda (y) (plus x y))))
  (setq add5 (maker 5))
  (add5 10))
(prog ()
  (setq counter (lambda ()
    (prog (n)
      (setq n 0)
      (lambda ()
        (setq n (plus n 1))
        n))))
  (setq c (counter))
  (cons (c) (cons (c) (cons (c) null))))

# 26. Semantic errors: closure usage errors
(setq bad-closure (lambda (x) (plus x y)))
(bad-closure 5)
((lambda () (break)))
(prog () (setq f (lambda (x) x)) (f))

# 27. Type errors in operations
(plus "hello" 1)
(times true false)
(and 1 2)
(or "a" "b")
(not 0)
(less null null)

# 28. Argument evaluation order and side effects
(prog (a)
  (setq a 0)
  (plus (setq a (plus a 1))
        (setq a (plus a 2)))
  a)
(prog (x y)
  (setq x 1)
  (setq y 2)
  (times (setq x (times x 3))
         (setq y (times y 4))))

# 29. Semantic errors: arity mismatches
(plus 1)
(plus 1 2 3)
(not)
(not true false)
(and true)
(and true false true)
(less 1)
(less 1 2 3)
(head)
(head '(1) 2)
(cons 1)
(cons 1 2 3)

# 30. Semantic errors: type mismatch when types are known
(plus true 1)
(times 2 false)
(and 1 false)
(or true 0)
(not 1)
(while 1 (break))
(cond 2 10 20)
(head 42)
(tail "string")
(cons true false)
